<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rotaract Club Invoice Calculator | Rotaract South Asia MDIO</title>

	<meta name="description" content="Club Invoice Calculator is an interactive tool by Rotaract South Asia MDIO (RSAMDIO) that helps Rotaractors to estimate their Club Invoices.">
	<meta name="author" content="ZeoSpec">

	<link rel="canonical" href="https://rsamdio.org/invoice"> 

    <meta property="og:title" content="Rotaract Club Invoice Calculator | Rotaract South Asia MDIO">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://rsamdio.org/invoice">
    <meta property="og:site_name" content="Rotaract Club Invoice Calculator | Rotaract South Asia MDIO" />
    <meta property="og:image" content="https://rsamdio.org/img/calculatorogimg.png" />
    <meta property="og:description" content="Club Invoice Calculator is an interactive tool by Rotaract South Asia MDIO (RSAMDIO) that helps Rotaractors to estimate their Club Invoices.">
    
    <meta name="keywords" content="Rotaract, Rotary, Rotaract South Asia, Club Invoice, RSAMDIO, RI Dues" />

    <meta name="subject" content="Rotaract Club Invoice Calculator | Rotaract South Asia MDIO">

	<meta name="url" content="https://rsamdio.org">
    <meta name="identifier-URL" content="https://rsamdio.org">
    
	<meta http-equiv="cache-control" content="public" />
    <meta http-equiv="Expires" content="0">
    
	
	<!--Favicon-->
	<link rel="shortcut icon" href="./img/favicon.png" type="image/x-icon">
	<link rel="icon" href="./img/favicon.png" type="image/x-icon">
	

    <script src="https://cdn.tailwindcss.com"></script>
    <!-- SheetJS for Excel parsing -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <!-- PapaParse for CSV parsing -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f7fafc;
            color: #4a5568;
        }
        .rotary-blue-dark { background-color: #003b8a; }
        .rotary-blue-dark-text { color: #003b8a; }
        .rotary-blue-light { background-color: #eaf2ff; }
        .rotary-blue-light-text { color: #004aad; }
        .btn {
            padding: 0.625rem 1.25rem;
            border-radius: 0.5rem;
            font-weight: 600;
            transition: all 0.2s ease-in-out;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            border: 1px solid transparent;
        }
        .btn-primary {
            background-color: #004aad;
            color: white;
        }
        .btn-primary:hover {
            background-color: #003b8a;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 74, 173, 0.2);
        }
        .btn-danger {
            background-color: #e53e3e;
            color: white;
        }
        .btn-danger:hover {
            background-color: #c53030;
        }
        .btn-secondary {
            background-color: #edf2f7;
            color: #4a5568;
            border-color: #e2e8f0;
        }
        .btn-secondary:hover {
            background-color: #e2e8f0;
        }
        .card {
            background-color: white;
            border-radius: 0.75rem;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05), 0 2px 4px -1px rgba(0, 0, 0, 0.03);
            border: 1px solid #e2e8f0;
        }
        input[type="text"], input[type="date"], select {
            background-color: #f7fafc;
            border: 1px solid #e2e8f0;
            border-radius: 0.5rem;
            padding: 0.625rem 0.875rem;
            transition: border-color 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
        }
        input[type="text"]:focus, input[type="date"]:focus, select:focus {
            outline: none;
            border-color: #0079ff;
            box-shadow: 0 0 0 3px rgba(0, 121, 255, 0.15);
            background-color: white;
        }
        .table-header {
            background-color: #f7fafc;
        }
        .form-input-sm, .form-select-sm {
            padding: 0.25rem 0.5rem;
            font-size: 0.875rem;
        }
        .file-upload-area {
            border: 2px dashed #d1d5db;
            border-radius: 0.5rem;
            transition: all 0.2s ease-in-out;
        }
        .file-upload-area:hover {
            border-color: #004aad;
            background-color: #f8fafc;
        }
        .file-upload-area.dragover {
            border-color: #004aad;
            background-color: #eaf2ff;
        }
        .upload-preview {
            max-height: 200px;
            overflow-y: auto;
        }
        .member-row {
            transition: all 0.2s ease-in-out;
        }
        .member-row:hover {
            background-color: #f8fafc;
            transform: translateY(-1px);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }
        .btn-sm {
            padding: 0.375rem 0.75rem;
            font-size: 0.875rem;
            border-radius: 0.375rem;
        }
        .animate-pulse {
            animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }
        @keyframes pulse {
            0%, 100% {
                opacity: 1;
            }
            50% {
                opacity: .5;
            }
        }
    </style>

	<!-- Google tag (gtag.js) -->
	<script async src="https://www.googletagmanager.com/gtag/js?id=G-QZDYH5YMXH"></script>
	<script>
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());

	gtag('config', 'G-QZDYH5YMXH');
	</script>

</head>
<body class="antialiased">

    <div class="container mx-auto p-4 sm:p-6 lg:p-8">

        <!-- Header -->
        <header class="text-center mb-12">
            <div class="bg-gradient-to-br from-blue-50 to-indigo-50 rounded-3xl p-8 mb-8 border border-blue-100">
                <img src="https://res.cloudinary.com/frontly/image/upload/v1719324049/pink_v5vpyh.png" alt="Rotaract Logo" class="mx-auto h-24 mb-6 drop-shadow-lg">
                <h1 class="text-4xl sm:text-5xl font-bold bg-gradient-to-r from-blue-600 to-indigo-600 bg-clip-text text-transparent mb-4">Rotaract Club Invoice Calculator</h1>
                <p class="text-lg text-gray-600 max-w-3xl mx-auto leading-relaxed">An interactive tool that helps Rotaractors to estimate their Club Invoices with precision and ease.</p>
                <div class="flex items-center justify-center mt-6 space-x-4 text-sm text-gray-500">
                    <div class="flex items-center">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
                        </svg>
                        Easy to use
                    </div>
                    <div class="flex items-center">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
                        </svg>
                        Bulk upload support
                    </div>
                    <div class="flex items-center">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
                        </svg>
                        Real-time calculations
                    </div>
                </div>
            </div>
        </header>

        <main class="grid grid-cols-1 lg:grid-cols-3 gap-8">

            <!-- Left Column: Add Member & Bulk Upload -->
            <div class="lg:col-span-1 space-y-6">
                <!-- Add New Member Card -->
                <div class="card p-6 shadow-lg border-0">
                    <div class="text-center mb-6">
                        <div class="w-12 h-12 bg-gradient-to-r from-blue-500 to-blue-600 rounded-full flex items-center justify-center mx-auto mb-3">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
                            </svg>
                        </div>
                        <h2 class="text-xl font-bold text-gray-800">Add New Member</h2>
                        <p class="text-sm text-gray-500 mt-1">Add individual members to your roster</p>
                    </div>
                    <form id="add-member-form" class="space-y-5">
                        <div class="space-y-2">
                            <label for="member-name" class="block text-sm font-semibold text-gray-700 text-center">Member Name</label>
                            <input type="text" id="member-name" required class="w-full px-4 py-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200 text-center">
                        </div>
                        <div class="space-y-2">
                            <label for="member-type" class="block text-sm font-semibold text-gray-700 text-center">Member Type</label>
                            <select id="member-type" required class="w-full px-4 py-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200 text-center">
                                <option value="Community-Based">Community-Based ($8)</option>
                                <option value="University-Based">University-Based ($5)</option>
                            </select>
                        </div>
                        <div class="space-y-2">
                            <label for="join-date" class="block text-sm font-semibold text-gray-700 text-center">Join Date</label>
                            <input type="date" id="join-date" required class="w-full px-4 py-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200 text-center">
                        </div>
                        <button type="submit" id="add-member-button" class="btn btn-primary w-full !mt-6 py-3 text-base font-semibold shadow-lg hover:shadow-xl transform hover:-translate-y-0.5 transition-all duration-200">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" viewBox="0 0 20 20" fill="currentColor"><path d="M10.75 4.75a.75.75 0 00-1.5 0v4.5h-4.5a.75.75 0 000 1.5h4.5v4.5a.75.75 0 001.5 0v-4.5h4.5a.75.75 0 000-1.5h-4.5v-4.5z" /></svg>
                            Add Member
                        </button>
                    </form>
                </div>

                <!-- Bulk Upload Card -->
                <div class="card p-6 shadow-lg border-0">
                    <div class="text-center mb-6">
                        <div class="w-12 h-12 bg-gradient-to-r from-green-500 to-green-600 rounded-full flex items-center justify-center mx-auto mb-3">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12" />
                            </svg>
                        </div>
                        <h2 class="text-xl font-bold text-gray-800">Bulk Upload Roster</h2>
                        <p class="text-sm text-gray-500 mt-1">Upload multiple members at once</p>
                    </div>
                    
                    <!-- File Upload Area -->
                    <div id="file-upload-area" class="file-upload-area p-8 text-center mb-6 bg-gradient-to-br from-gray-50 to-gray-100">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-16 w-16 mx-auto text-gray-400 mb-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12" />
                        </svg>
                        <p class="text-base text-gray-600 mb-3 font-medium">Drag and drop your file here, or</p>
                        <input type="file" id="file-input" accept=".xlsx,.xls,.csv" class="hidden">
                        <button type="button" id="browse-button" class="btn btn-secondary text-sm px-6 py-3 shadow-md hover:shadow-lg transform hover:-translate-y-0.5 transition-all duration-200">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6" />
                            </svg>
                            Browse Files
                        </button>
                        <p class="text-xs text-gray-500 mt-3">Supports Excel (.xlsx, .xls) and CSV files</p>
                    </div>

                    <!-- File Format Instructions -->
                    <div class="bg-gradient-to-r from-blue-50 to-indigo-50 p-5 rounded-xl border border-blue-100 mb-6">
                        <h3 class="text-sm font-bold text-blue-800 mb-3 flex items-center">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                            </svg>
                            Expected File Format
                        </h3>
                        <div class="text-sm text-blue-700 space-y-2">
                            <div class="flex items-center">
                                <span class="w-6 h-6 bg-blue-200 rounded-full flex items-center justify-center text-xs font-bold text-blue-800 mr-3">A</span>
                                <span><strong>Member Name</strong> (e.g., John Doe)</span>
                            </div>
                            <div class="flex items-center">
                                <span class="w-6 h-6 bg-blue-200 rounded-full flex items-center justify-center text-xs font-bold text-blue-800 mr-3">B</span>
                                <span><strong>Join Date</strong> (YYYY-MM-DD format)</span>
                            </div>
                            <div class="flex items-center">
                                <span class="w-6 h-6 bg-blue-200 rounded-full flex items-center justify-center text-xs font-bold text-blue-800 mr-3">C</span>
                                <span><strong>Member Type</strong> (Community-Based or University-Based)</span>
                            </div>
                        </div>
                        <div class="mt-4 pt-3 border-t border-blue-200">
                            <button type="button" id="download-template" class="text-sm text-blue-600 hover:text-blue-800 font-medium flex items-center">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                                </svg>
                                Download Template
                            </button>
                        </div>
                    </div>

                    <!-- Upload Preview -->
                    <div id="upload-preview" class="hidden">
                        <h3 class="text-sm font-bold text-gray-700 mb-3 flex items-center">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
                            </svg>
                            Preview
                        </h3>
                        <div id="preview-content" class="upload-preview bg-gray-50 p-4 rounded-lg border border-gray-200 text-sm"></div>
                        <div class="flex gap-3 mt-4">
                            <button type="button" id="confirm-upload" class="btn btn-primary text-sm flex-1 py-3 shadow-md hover:shadow-lg transform hover:-translate-y-0.5 transition-all duration-200">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-2" viewBox="0 0 20 20" fill="currentColor">
                                    <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                                </svg>
                                Add to Roster
                            </button>
                            <button type="button" id="cancel-upload" class="btn btn-secondary text-sm py-3 px-4 shadow-md hover:shadow-lg transform hover:-translate-y-0.5 transition-all duration-200">
                                Cancel
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Right Column: Summary & Roster -->
            <div class="lg:col-span-2 space-y-8">
                <!-- Invoice Summary Card -->
                <div class="card p-8 shadow-lg border-0">
                    <div class="text-center mb-6">
                        <div class="w-16 h-16 bg-gradient-to-r from-blue-500 to-blue-600 rounded-full flex items-center justify-center mx-auto mb-4">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 7h6m0 10v-3m-3 3h.01M9 17h.01M9 14h.01M12 14h.01M15 11h.01M12 11h.01M9 11h.01M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z" />
                            </svg>
                        </div>
                        <h2 class="text-2xl font-bold text-gray-800 mb-2">Invoice Summary</h2>
                        <p class="text-gray-500">View your estimated club invoice</p>
                    </div>
                    
                    <div class="mb-6 flex flex-col items-center space-y-4">
                        <div class="flex flex-col sm:flex-row items-center gap-4">
                            <div class="flex flex-col items-center">
                                <label for="invoice-year-select" class="block text-sm font-semibold text-gray-700 mb-2 text-center">Invoice for Jan 1st of Year:</label>
                                <select id="invoice-year-select" class="w-full max-w-xs px-4 py-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200 text-center font-semibold"></select>
                            </div>
                            <div class="flex flex-col items-center">
                                <label for="tax-percentage" class="block text-sm font-semibold text-gray-700 mb-2 text-center">Tax Percentage (%):</label>
                                <input type="number" id="tax-percentage" min="0" max="100" step="0.01" value="18" class="w-full max-w-xs px-4 py-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200 text-center font-semibold" placeholder="18">
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-gradient-to-br from-blue-50 to-indigo-50 p-8 rounded-2xl border border-blue-100 text-center">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div>
                                <p class="text-lg text-blue-700 font-semibold mb-2">Base RI Dues</p>
                                <p id="base-invoice-amount" class="text-4xl font-bold text-blue-800 tracking-tight my-2">$0.00</p>
                            </div>
                            <div>
                                <p class="text-lg text-green-700 font-semibold mb-2">Total with Tax</p>
                                <p id="total-invoice-amount" class="text-4xl font-bold text-green-800 tracking-tight my-2">$0.00</p>
                            </div>
                        </div>
                        <div class="mt-4 pt-4 border-t border-blue-200">
                            <p id="tax-breakdown" class="text-sm text-gray-600">Tax: $0.00 (18%)</p>
                        </div>
                    </div>
                </div>

                <!-- Member Roster Card -->
                <div class="card p-8 shadow-lg border-0">
                    <div class="flex flex-col sm:flex-row justify-between sm:items-center mb-6">
                        <div class="flex items-center mb-4 sm:mb-0">
                            <div class="w-10 h-10 bg-gradient-to-r from-green-500 to-green-600 rounded-full flex items-center justify-center mr-3">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z" />
                                </svg>
                            </div>
                            <div>
                                <h2 class="text-xl font-bold text-gray-800">Member Roster</h2>
                                <p class="text-sm text-gray-500">Manage your club members</p>
                            </div>
                        </div>
                        <button id="reset-button" class="btn btn-secondary text-sm px-6 py-3 shadow-md hover:shadow-lg transform hover:-translate-y-0.5 transition-all duration-200">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" />
                            </svg>
                            Reset Roster
                        </button>
                    </div>
                    
                    <div class="overflow-x-auto -mx-8">
                        <table class="min-w-full">
                            <thead class="bg-gradient-to-r from-gray-50 to-gray-100">
                                <tr>
                                    <th scope="col" class="px-6 py-4 text-left text-xs font-bold text-gray-600 uppercase tracking-wider">Name</th>
                                    <th scope="col" class="px-6 py-4 text-left text-xs font-bold text-gray-600 uppercase tracking-wider">Join Date</th>
                                    <th scope="col" class="px-6 py-4 text-left text-xs font-bold text-gray-600 uppercase tracking-wider">Type</th>
                                    <th scope="col" class="px-6 py-4 text-left text-xs font-bold text-gray-600 uppercase tracking-wider">Est. Due</th>
                                    <th scope="col" class="relative px-6 py-4"><span class="sr-only">Actions</span></th>
                                </tr>
                            </thead>
                            <tbody id="member-roster-body" class="bg-white divide-y divide-gray-100">
                                <!-- Rows will be dynamically injected here -->
                            </tbody>
                        </table>
                    </div>
                    
                    <!-- Empty State -->
                    <div id="empty-state" class="text-center py-12">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-16 w-16 mx-auto text-gray-300 mb-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z" />
                        </svg>
                        <h3 class="text-lg font-medium text-gray-900 mb-2">No members yet</h3>
                        <p class="text-gray-500 mb-4">Add members individually or upload a roster file to get started</p>
                    </div>
                </div>
            </div>
        </main>

        <footer class="text-center mt-16 py-8 bg-gradient-to-r from-gray-50 to-gray-100 rounded-2xl border border-gray-200">
            <div class="max-w-4xl mx-auto px-6">
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-6">
                    <div class="text-center">
                        <div class="w-12 h-12 bg-gradient-to-r from-blue-500 to-blue-600 rounded-full flex items-center justify-center mx-auto mb-3">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                            </svg>
                        </div>
                        <h3 class="font-semibold text-gray-800 mb-2">Disclaimer</h3>
                        <p class="text-sm text-gray-600">All calculations are indicative estimates. Actual figures may vary based on various factors including but not limited to variation in data and RI Policies.</p>
                    </div>
                    <div class="text-center">
                        <div class="w-12 h-12 bg-gradient-to-r from-green-500 to-green-600 rounded-full flex items-center justify-center mx-auto mb-3">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
                            </svg>
                        </div>
                        <h3 class="font-semibold text-gray-800 mb-2">Contact</h3>
                        <p class="text-sm text-gray-600">PDRR Arun Teja Godavarthi</p>
                        <p class="text-sm text-blue-600">rotaract3191drr@gmail.com</p>
                    </div>
                    <div class="text-center">
                        <div class="w-12 h-12 bg-gradient-to-r from-purple-500 to-purple-600 rounded-full flex items-center justify-center mx-auto mb-3">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z" />
                            </svg>
                        </div>
                        <h3 class="font-semibold text-gray-800 mb-2">Copyright</h3>
                        <p class="text-sm text-gray-600">© <span id="current-year"></span> Rotaract South Asia MDIO</p>
                        <p class="text-sm text-gray-600">All rights reserved</p>
                    </div>
                </div>
                <div class="border-t border-gray-200 pt-6">
                    <p class="text-xs text-gray-500">This tool is designed to help Rotaract clubs estimate their invoice calculations efficiently and accurately.</p>
                </div>
            </div>
        </footer>

    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const addMemberForm = document.getElementById('add-member-form');
            const memberNameInput = document.getElementById('member-name');
            const memberTypeInput = document.getElementById('member-type');
            const joinDateInput = document.getElementById('join-date');
            const memberRosterBody = document.getElementById('member-roster-body');
            const totalInvoiceAmountEl = document.getElementById('total-invoice-amount');
            const resetButton = document.getElementById('reset-button');
            const invoiceYearSelect = document.getElementById('invoice-year-select');
            const invoiceDateDisplay = document.getElementById('invoice-date-display');
            const currentYearSpan = document.getElementById('current-year');
            const taxPercentageInput = document.getElementById('tax-percentage');
            const baseInvoiceAmountEl = document.getElementById('base-invoice-amount');
            const taxBreakdownEl = document.getElementById('tax-breakdown');

            // Bulk upload elements
            const fileUploadArea = document.getElementById('file-upload-area');
            const fileInput = document.getElementById('file-input');
            const browseButton = document.getElementById('browse-button');
            const uploadPreview = document.getElementById('upload-preview');
            const previewContent = document.getElementById('preview-content');
            const confirmUpload = document.getElementById('confirm-upload');
            const cancelUpload = document.getElementById('cancel-upload');
            const downloadTemplate = document.getElementById('download-template');

            let parsedMembers = [];

            const today = new Date();
            const yyyy = today.getFullYear();
            const mm = String(today.getMonth() + 1).padStart(2, '0');
            const dd = String(today.getDate()).padStart(2, '0');
            const todayFormatted = `${yyyy}-${mm}-${dd}`;
            joinDateInput.value = todayFormatted;
            currentYearSpan.textContent = yyyy;

            let lastSelectedMemberType = memberTypeInput.value;

            // Bulk Upload Functions
            function downloadCSVTemplate() {
                const csvContent = "Member Name,Join Date,Member Type\nJohn Doe,2024-01-15,Community-Based\nJane Smith,2024-02-01,University-Based";
                const blob = new Blob([csvContent], { type: 'text/csv' });
                const url = window.URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = 'rotaract_member_template.csv';
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                window.URL.revokeObjectURL(url);
            }

            function parseExcelFile(file) {
                return new Promise((resolve, reject) => {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        try {
                            const data = new Uint8Array(e.target.result);
                            const workbook = XLSX.read(data, { type: 'array' });
                            const firstSheetName = workbook.SheetNames[0];
                            const worksheet = workbook.Sheets[firstSheetName];
                            const jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1 });
                            
                            // Remove header row and process data
                            const processedData = jsonData.slice(1).filter(row => row.length >= 3);
                            resolve(processedData);
                        } catch (error) {
                            reject(error);
                        }
                    };
                    reader.onerror = reject;
                    reader.readAsArrayBuffer(file);
                });
            }

            function parseCSVFile(file) {
                return new Promise((resolve, reject) => {
                    Papa.parse(file, {
                        complete: function(results) {
                            if (results.errors.length > 0) {
                                reject(new Error('CSV parsing error: ' + results.errors[0].message));
                                return;
                            }
                            // Remove header row and process data
                            const processedData = results.data.slice(1).filter(row => row.length >= 3);
                            resolve(processedData);
                        },
                        error: function(error) {
                            reject(error);
                        }
                    });
                });
            }

            function validateMemberData(data) {
                const validatedMembers = [];
                const errors = [];

                data.forEach((row, index) => {
                    const [name, joinDate, memberType] = row;
                    
                    // Validate name
                    if (!name || typeof name !== 'string' || name.trim() === '') {
                        errors.push(`Row ${index + 2}: Invalid member name`);
                        return;
                    }

                    // Validate join date
                    const dateRegex = /^\d{4}-\d{2}-\d{2}$/;
                    if (!joinDate || !dateRegex.test(joinDate)) {
                        errors.push(`Row ${index + 2}: Invalid join date format (use YYYY-MM-DD)`);
                        return;
                    }

                    // Validate member type
                    const validTypes = ['Community-Based', 'University-Based'];
                    if (!validTypes.includes(memberType)) {
                        errors.push(`Row ${index + 2}: Invalid member type (use "Community-Based" or "University-Based")`);
                        return;
                    }

                    validatedMembers.push({
                        name: name.trim(),
                        joinDate: joinDate,
                        memberType: memberType
                    });
                });

                return { validatedMembers, errors };
            }

            function showPreview(members) {
                const previewHTML = members.map((member, index) => {
                    const typeText = member.memberType === 'Community-Based' ? 'Community-Based ($8)' : 'University-Based ($5)';
                    return `
                        <div class="flex justify-between items-center py-2 border-b border-gray-200 last:border-b-0">
                            <div class="flex-1">
                                <span class="font-medium text-gray-800">${member.name}</span>
                                <span class="text-gray-500 ml-3">${member.joinDate}</span>
                                <span class="text-gray-500 ml-3">${typeText}</span>
                            </div>
                        </div>
                    `;
                }).join('');

                previewContent.innerHTML = previewHTML;
                uploadPreview.classList.remove('hidden');
            }

            function handleFileUpload(file) {
                const fileExtension = file.name.split('.').pop().toLowerCase();
                
                let parsePromise;
                if (fileExtension === 'csv') {
                    parsePromise = parseCSVFile(file);
                } else if (['xlsx', 'xls'].includes(fileExtension)) {
                    parsePromise = parseExcelFile(file);
                } else {
                    alert('Unsupported file format. Please upload a CSV or Excel file.');
                    return;
                }

                parsePromise.then(data => {
                    const validation = validateMemberData(data);
                    
                    if (validation.errors.length > 0) {
                        alert('Validation errors found:\n\n' + validation.errors.join('\n'));
                        return;
                    }

                    parsedMembers = validation.validatedMembers;
                    showPreview(parsedMembers);
                }).catch(error => {
                    alert('Error parsing file: ' + error.message);
                });
            }

            function addBulkMembers() {
                if (parsedMembers.length === 0) return;

                const selectedYear = parseInt(invoiceYearSelect.value, 10);
                
                parsedMembers.forEach(member => {
                    const individualDue = calculateIndividualDue(member.joinDate, member.memberType, selectedYear);
                    const memberId = `member-${Date.now()}-${Math.random()}`;
                    
                    const row = document.createElement('tr');
                    row.id = memberId;
                    row.dataset.due = individualDue;
                    row.dataset.joinDate = member.joinDate;
                    row.dataset.memberType = member.memberType;
                    row.dataset.name = member.name;
                    row.classList.add('member-row');
                    
                    row.innerHTML = `
                        <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-800">${member.name}</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${member.joinDate}</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${member.memberType}</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 font-medium due-cell">$${individualDue.toFixed(2)}</td>
                        <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium">
                            <button class="btn btn-secondary btn-sm !p-2 edit-member-btn">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" viewBox="0 0 20 20" fill="currentColor"><path d="M17.414 2.586a2 2 0 00-2.828 0L7 10.172V13h2.828l7.586-7.586a2 2 0 000-2.828z" /><path fill-rule="evenodd" d="M2 6a2 2 0 012-2h4a1 1 0 010 2H4v10h10v-4a1 1 0 112 0v4a2 2 0 01-2 2H4a2 2 0 01-2-2V6z" clip-rule="evenodd" /></svg>
                            </button>
                            <button class="btn btn-danger btn-sm !p-2 remove-member-btn">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm4 0a1 1 0 012 0v6a1 1 0 11-2 0V8z" clip-rule="evenodd" /></svg>
                            </button>
                        </td>
                    `;
                    
                    memberRosterBody.appendChild(row);

                    row.querySelector('.edit-member-btn').addEventListener('click', () => editMember(memberId));
                    row.querySelector('.remove-member-btn').addEventListener('click', () => {
                        row.remove();
                        updateTotal();
                    });
                });

                updateTotal();
                resetBulkUpload();
            }

            function resetBulkUpload() {
                parsedMembers = [];
                uploadPreview.classList.add('hidden');
                fileInput.value = '';
            }

            function populateYearSelector() {
                const currentYear = new Date().getFullYear();
                const startInvoiceYear = 2023;
                const endInvoiceYear = currentYear + 25;
                for (let year = startInvoiceYear; year <= endInvoiceYear; year++) {
                    const option = document.createElement('option');
                    option.value = year;
                    option.textContent = year;
                    invoiceYearSelect.appendChild(option);
                }
                invoiceYearSelect.value = currentYear + 1;
                updateInvoiceDateDisplay();
            }

            function updateInvoiceDateDisplay() {
                const selectedYear = invoiceYearSelect.value;
                if(invoiceDateDisplay) invoiceDateDisplay.textContent = `Jan 1st, ${selectedYear}`;
            }

            function calculateIndividualDue(joinDateStr, memberType, invoiceYear) {
                const joinDate = new Date(joinDateStr + 'T00:00:00');
                const baseDues = memberType === 'Community-Based' ? 8 : 5;
                const joinYear = joinDate.getFullYear();
                if (joinYear >= invoiceYear) return 0;
                if (joinYear === invoiceYear - 1) {
                    const joinMonth = joinDate.getMonth();
                    const joinDay = joinDate.getDate();
                    let effectiveJoinMonth = joinMonth;
                    if (joinDay > 15) effectiveJoinMonth += 1;
                    if (effectiveJoinMonth >= 12) return baseDues;
                    const monthsInJoinYear = 12 - effectiveJoinMonth;
                    const proratedDues = (baseDues / 12) * monthsInJoinYear;
                    return baseDues + proratedDues;
                }
                if (joinYear < invoiceYear - 1) return baseDues;
                return 0;
            }

            function updateTotal() {
                let baseTotal = 0;
                const memberRows = memberRosterBody.querySelectorAll('tr');
                memberRows.forEach(row => {
                    baseTotal += parseFloat(row.dataset.due || 0);
                });
                
                // Calculate tax
                const taxPercentage = parseFloat(taxPercentageInput.value) || 0;
                const taxAmount = (baseTotal * taxPercentage) / 100;
                const totalWithTax = baseTotal + taxAmount;
                
                // Update display
                baseInvoiceAmountEl.textContent = `$${baseTotal.toFixed(2)}`;
                totalInvoiceAmountEl.textContent = `$${totalWithTax.toFixed(2)}`;
                taxBreakdownEl.textContent = `Tax: $${taxAmount.toFixed(2)} (${taxPercentage}%)`;
                
                // Show/hide empty state
                const emptyState = document.getElementById('empty-state');
                if (memberRows.length === 0) {
                    emptyState.classList.remove('hidden');
                } else {
                    emptyState.classList.add('hidden');
                }
            }
            
            function recalculateAllDues() {
                const selectedYear = parseInt(invoiceYearSelect.value, 10);
                const memberRows = memberRosterBody.querySelectorAll('tr');
                memberRows.forEach(row => {
                    if (row.classList.contains('editing')) return; // Skip editing rows
                    const joinDate = row.dataset.joinDate;
                    const memberType = row.dataset.memberType;
                    const individualDue = calculateIndividualDue(joinDate, memberType, selectedYear);
                    row.dataset.due = individualDue;
                    row.querySelector('.due-cell').textContent = `$${individualDue.toFixed(2)}`;
                });
                updateTotal();
                updateInvoiceDateDisplay();
            }

            function addMember(e) {
                e.preventDefault();
                const name = memberNameInput.value;
                const typeValue = memberTypeInput.value;
                const joinDate = joinDateInput.value;
                if (!name || !typeValue || !joinDate) {
                    alert('Please fill out all fields.');
                    return;
                }

                const selectedYear = parseInt(invoiceYearSelect.value, 10);
                const individualDue = calculateIndividualDue(joinDate, typeValue, selectedYear);
                const memberId = `member-${Date.now()}`;
                const row = document.createElement('tr');
                row.id = memberId;
                row.dataset.due = individualDue;
                row.dataset.joinDate = joinDate;
                row.dataset.memberType = typeValue;
                row.dataset.name = name;
                row.classList.add('member-row');
                
                row.innerHTML = `
                    <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-800">${name}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${joinDate}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${typeValue}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 font-medium due-cell">$${individualDue.toFixed(2)}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium">
                        <button class="btn btn-secondary btn-sm !p-2 edit-member-btn">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" viewBox="0 0 20 20" fill="currentColor"><path d="M17.414 2.586a2 2 0 00-2.828 0L7 10.172V13h2.828l7.586-7.586a2 2 0 000-2.828z" /><path fill-rule="evenodd" d="M2 6a2 2 0 012-2h4a1 1 0 010 2H4v10h10v-4a1 1 0 112 0v4a2 2 0 01-2 2H4a2 2 0 01-2-2V6z" clip-rule="evenodd" /></svg>
                        </button>
                        <button class="btn btn-danger btn-sm !p-2 remove-member-btn">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm4 0a1 1 0 012 0v6a1 1 0 11-2 0V8z" clip-rule="evenodd" /></svg>
                        </button>
                    </td>
                `;
                memberRosterBody.appendChild(row);

                row.querySelector('.edit-member-btn').addEventListener('click', () => editMember(memberId));
                row.querySelector('.remove-member-btn').addEventListener('click', () => {
                    row.remove();
                    updateTotal();
                });
                
                lastSelectedMemberType = typeValue;
                updateTotal();
                addMemberForm.reset();
                joinDateInput.value = todayFormatted;
                memberTypeInput.value = lastSelectedMemberType;
            }

            function editMember(memberId) {
                const row = document.getElementById(memberId);
                if (!row || row.classList.contains('editing')) return;

                document.querySelectorAll('.edit-member-btn').forEach(btn => btn.disabled = true);
                row.classList.add('editing');

                const name = row.dataset.name;
                const joinDate = row.dataset.joinDate;
                const memberType = row.dataset.memberType;

                row.cells[0].innerHTML = `<input type="text" value="${name}" class="w-full form-input-sm">`;
                row.cells[1].innerHTML = `<input type="date" value="${joinDate}" class="w-full form-input-sm">`;
                row.cells[2].innerHTML = `
                    <select class="w-full form-select-sm">
                        <option value="Community-Based" ${memberType === 'Community-Based' ? 'selected' : ''}>Community-Based ($8)</option>
                        <option value="University-Based" ${memberType === 'University-Based' ? 'selected' : ''}>University-Based ($5)</option>
                    </select>
                `;
                row.cells[3].innerHTML = '';
                row.cells[4].innerHTML = `
                    <button class="btn btn-primary btn-sm !p-2 save-member-btn">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" /></svg>
                    </button>
                    <button class="btn btn-secondary btn-sm !p-2 cancel-edit-btn">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd" /></svg>
                    </button>
                `;

                row.querySelector('.save-member-btn').addEventListener('click', () => saveMember(memberId));
                row.querySelector('.cancel-edit-btn').addEventListener('click', () => cancelEdit(memberId));
            }

            function saveMember(memberId) {
                const row = document.getElementById(memberId);
                if (!row) return;

                const newName = row.cells[0].querySelector('input').value;
                const newJoinDate = row.cells[1].querySelector('input').value;
                const newMemberType = row.cells[2].querySelector('select').value;

                row.dataset.name = newName;
                row.dataset.joinDate = newJoinDate;
                row.dataset.memberType = newMemberType;

                const selectedYear = parseInt(invoiceYearSelect.value, 10);
                const individualDue = calculateIndividualDue(newJoinDate, newMemberType, selectedYear);
                row.dataset.due = individualDue;

                row.cells[0].textContent = newName;
                row.cells[1].textContent = newJoinDate;
                row.cells[2].textContent = newMemberType;
                row.cells[3].textContent = `$${individualDue.toFixed(2)}`;
                row.cells[3].classList.add('due-cell');
                
                finishEditing(row, memberId);
                recalculateAllDues();
            }

            function cancelEdit(memberId) {
                const row = document.getElementById(memberId);
                if (!row) return;

                const name = row.dataset.name;
                const joinDate = row.dataset.joinDate;
                const memberType = row.dataset.memberType;
                const due = row.dataset.due;

                row.cells[0].textContent = name;
                row.cells[1].textContent = joinDate;
                row.cells[2].textContent = memberType;
                row.cells[3].textContent = `$${parseFloat(due).toFixed(2)}`;
                row.cells[3].classList.add('due-cell');

                finishEditing(row, memberId);
            }

            function finishEditing(row, memberId) {
                row.classList.remove('editing');
                row.cells[4].innerHTML = `
                    <button class="btn btn-secondary btn-sm !p-2 edit-member-btn">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" viewBox="0 0 20 20" fill="currentColor"><path d="M17.414 2.586a2 2 0 00-2.828 0L7 10.172V13h2.828l7.586-7.586a2 2 0 000-2.828z" /><path fill-rule="evenodd" d="M2 6a2 2 0 012-2h4a1 1 0 010 2H4v10h10v-4a1 1 0 112 0v4a2 2 0 01-2 2H4a2 2 0 01-2-2V6z" clip-rule="evenodd" /></svg>
                    </button>
                    <button class="btn btn-danger btn-sm !p-2 remove-member-btn">
                         <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm4 0a1 1 0 012 0v6a1 1 0 11-2 0V8z" clip-rule="evenodd" /></svg>
                    </button>
                `;
                row.querySelector('.edit-member-btn').addEventListener('click', () => editMember(memberId));
                row.querySelector('.remove-member-btn').addEventListener('click', () => {
                    row.remove();
                    updateTotal();
                });
                document.querySelectorAll('.edit-member-btn').forEach(btn => btn.disabled = false);
            }
            
            function resetCalculator() {
                memberRosterBody.innerHTML = '';
                updateTotal();
            }

            addMemberForm.addEventListener('submit', addMember);
            resetButton.addEventListener('click', resetCalculator);
            invoiceYearSelect.addEventListener('change', recalculateAllDues);
            taxPercentageInput.addEventListener('input', updateTotal);

            // Bulk upload event listeners
            browseButton.addEventListener('click', () => fileInput.click());
            
            fileInput.addEventListener('change', (e) => {
                const file = e.target.files[0];
                if (file) {
                    handleFileUpload(file);
                }
            });

            // Drag and drop functionality
            fileUploadArea.addEventListener('dragover', (e) => {
                e.preventDefault();
                fileUploadArea.classList.add('dragover');
            });

            fileUploadArea.addEventListener('dragleave', () => {
                fileUploadArea.classList.remove('dragover');
            });

            fileUploadArea.addEventListener('drop', (e) => {
                e.preventDefault();
                fileUploadArea.classList.remove('dragover');
                const file = e.dataTransfer.files[0];
                if (file) {
                    handleFileUpload(file);
                }
            });

            confirmUpload.addEventListener('click', addBulkMembers);
            cancelUpload.addEventListener('click', resetBulkUpload);
            downloadTemplate.addEventListener('click', downloadCSVTemplate);

            populateYearSelector();
        });
    </script>
</body>
</html>